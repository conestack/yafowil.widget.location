!function(t,e){"use strict";class i{constructor(t,e){this.widget=t,this.marker=e,this.create_popup()}create_popup(){let t=document.createElement("a");t.href="#",t.innerHTML="Remove",t.onclick=this.remove_handle.bind(this),this.marker.bindPopup(t)}remove_handle(){let t=this.widget;return t.markers.removeLayer(this.marker),t.lat="",t.lon="",t.zoom="",!1}}class o{constructor(t,e,o){this.widget=t;let a=new L.marker([e,o],{draggable:!0});a.addTo(t.markers),new i(t,a),a.on("dragend",this.dragend_handle.bind(this))}dragend_handle(t){let e=t.target._latlng,i=this.widget;i.lat=e.lat,i.lon=e.lng,i.zoom=i.map.getZoom()}}class a{constructor(t){this.widget=t;let e=this.geosearch=new GeoSearch.GeoSearchControl({provider:new GeoSearch.OpenStreetMapProvider});t.map.addControl(e),t.map.on("geosearch_showlocation",this.geosearch_handle.bind(this))}geosearch_handle(t){let e=this.geosearch._resultslist;e.innerHTML=`<li>${t.Location.Label}</li>`,e.style.display="block",setTimeout((function(){e.style.display="none"}),3e3)}}class n{static initialize(t){e("div.location-map",t).each((function(){new n(e(this))}))}constructor(t){this.elem=t,this.id=t.attr("id");let i=t.parent();this._input_lat=e("input.location-lat",i),this._input_lon=e("input.location-lon",i),this._input_zoom=e("input.location-zoom",i),this.min_zoom=t.data("min_zoom"),this.max_zoom=t.data("max_zoom"),this._lat=t.data("lat"),this._lon=t.data("lon"),this._zoom=t.data("zoom"),this.value=this.elem.data("value"),this.create_map(),new a(this)}get value(){return this._value}set value(t){this._value=t,t&&(void 0!==t.lat&&void 0!==t.lon&&(this._lat=t.lat,this._lon=t.lon),void 0!==t.zoom&&(this._zoom=t.zoom))}get lat(){return this._lat}set lat(t){this._lat=t,this._input_lat.val(t)}get lon(){return this._lon}set lon(t){this._lon=t,this._input_lon.val(t)}get zoom(){return this._zoom}set zoom(t){this._zoom=t,this._input_zoom.val(t)}create_map(){let t=this.map=new L.map(this.id);this.map.setView([this.lat,this.lon],this.zoom),new L.tileLayer("//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data Â© <a href="http://openstreetmap.org">OSM</a>',minZoom:this.min_zoom,maxZoom:this.max_zoom}).addTo(t);let e=this.markers=new L.FeatureGroup;t.addLayer(e),this.value&&new o(this,this.lat,this.lon),t.on("click",this.click_handle.bind(this))}click_handle(t){this.markers.clearLayers();let e=t.latlng;new o(this,e.lat,e.lng),this.lat=e.lat,this.lon=e.lng,this.zoom=this.map.getZoom()}}e((function(){void 0!==window.ts?ts.ajax.register(n.initialize,!0):n.initialize()})),t.LocationWidget=n,t.LocationWidgetMarker=o,t.LocationWidgetMarkerPopup=i,t.LocationWidgetSearch=a,Object.defineProperty(t,"__esModule",{value:!0}),void 0===window.yafowil&&(window.yafowil={}),window.yafowil.location=t}({},jQuery);
//# sourceMappingURL=widget.min.js.map
